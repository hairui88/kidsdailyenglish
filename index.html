<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Daily English â€” Day 2 (SpeechSynthesis only)</title>
<style>
  :root{--blue:#2563eb;--muted:#64748b;--card:#fff;}
  body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial; background:#f8fafc;margin:20px;padding:0;color:#0f172a;}
  .wrap{max-width:880px;margin:18px auto;}
  header{display:flex;align-items:center;gap:12px;margin-bottom:12px;}
  .logo{width:48px;height:48px;border-radius:10px;background:#e6eef8;display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--blue);}
  h1{font-size:20px;margin:0;}
  .card{background:var(--card);border-radius:14px;padding:28px;box-shadow:0 1px 0 rgba(2,6,23,0.04);border:1px solid #eef2f7;}
  .word{font-size:42px;font-weight:800;margin-bottom:6px;}
  .ipa{color:#475569;margin-bottom:12px;font-family:Arial,Helvetica,sans-serif;}
  .cn{color:#0f172a;margin-bottom:14px;font-size:18px;}
  .sentence{color:#0f172a;font-size:16px;margin-bottom:18px;}
  .controls{display:flex;flex-wrap:wrap;gap:10px;}
  button{border:0;background:#fff;padding:10px 14px;border-radius:10px;border:1px solid #e6eef8;cursor:pointer;}
  button.primary{background:var(--blue);color:#fff;border-color:var(--blue);box-shadow:0 6px 16px rgba(37,99,235,0.12);}
  .muted{color:var(--muted);margin-top:12px;font-size:13px;}
  .small{font-size:13px;color:var(--muted);}
  .controls .iconbtn{display:inline-flex;align-items:center;gap:8px;}
  .highlight{background:#f1f9ff}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="logo">EN</div>
    <div>
      <h1>Daily English ğŸ”Š â€” Day 2 (SpeechSynthesis only)</h1>
      <div class="small">Uses device's built-in TTS. If no sound, first tap any button to unlock audio on mobile.</div>
    </div>
  </header>

  <main class="card" role="main" aria-label="word card">
    <div id="cardContent">
      <div class="word" id="word">window</div>
      <div class="ipa" id="ipa">/ËˆwÉªn.doÊŠ/</div>
      <div class="cn" id="cn">çª—æˆ·</div>
      <div class="sentence" id="sentence">Please open the window.</div>
    </div>

    <div style="height:8px"></div>
    <div class="controls">
      <button id="playWord" class="iconbtn">ğŸ”Š Word</button>
      <button id="playSentence" class="iconbtn">ğŸ”Š Sentence</button>
      <button id="playBoth" class="iconbtn">â–¶ï¸ WordÃ—3 â†’ SentenceÃ—3</button>
      <button id="toggleCn" class="iconbtn">ğŸ‘ï¸ Hide/Show ä¸­æ–‡</button>
      <button id="nextBtn" class="primary">â¡ï¸ Next</button>
      <button id="shuffle" class="iconbtn">ğŸ”€ Shuffle</button>
    </div>

    <div class="muted">Tip: On iPhone use Safari; first tap any button to allow audio. Ensure device volume is up and silent mode off.</div>
  </main>
</div>

<script>
const data = [
  ["window","/ËˆwÉªn.doÊŠ/","çª—æˆ·","Please open the window."],
  ["car","/kÉ‘Ër/","æ±½è½¦","My father drives a new car."],
  ["bus","/bÊŒs/","å…¬å…±æ±½è½¦","We go to school by bus."],
  ["street","/striËt/","è¡—é“","There are many shops on this street."],
  ["shop","/ÊƒÉ‘Ëp/","å•†åº—","Let's go to the shop and buy some fruit."],
  ["money","/ËˆmÊŒ.ni/","é’±","I don't have enough money."],
  ["cake","/keÉªk/","è›‹ç³•","I made a chocolate cake for my mother."],
  ["birthday","/ËˆbÉœËÎ¸.deÉª/","ç”Ÿæ—¥","Today is my sister's birthday."],
  ["party","/ËˆpÉ‘Ër.ti/","èšä¼š","We had a great time at the party."],
  ["music","/ËˆmjuË.zÉªk/","éŸ³ä¹","I like listening to pop music."],
  ["dance","/dÃ¦ns/","è·³èˆ","She can dance very well."],
  ["food","/fuËd/","é£Ÿç‰©","The food smells delicious."],
  ["juice","/dÊ’uËs/","æœæ±","I drink orange juice every morning."],
  ["glass","/É¡lÃ¦s/","æ¯å­ï¼›ç»ç’ƒ","Be careful! The glass might break."],
  ["breakfast","/Ëˆbrek.fÉ™st/","æ—©é¤","We have breakfast at 7 o'clock."]
];

let idx = 0;

function render(){
  const d = data[idx];
  document.getElementById('word').textContent = d[0];
  document.getElementById('ipa').textContent = d[1];
  document.getElementById('cn').textContent = d[2];
  document.getElementById('sentence').textContent = d[3];
  document.querySelectorAll('.item').forEach(el=>el.classList && el.classList.remove('highlight'));
  const row = document.querySelector(`[data-index="${idx}"]`);
  if(row) row.classList.add('highlight');
}
render();

// choose a likely en-US female voice if available
function chooseVoice(){
  const voices = speechSynthesis.getVoices();
  if(!voices || voices.length===0) return null;
  // prefer en-US female names
  let v = voices.find(v=>/en-?us/i.test(v.lang) && /female|female/i.test(v.name));
  if(!v) v = voices.find(v=>/en-?us/i.test(v.lang));
  if(!v) v = voices.find(v=>v.lang && v.lang.startsWith('en'));
  return v || voices[0];
}

function speakOnce(text){
  return new Promise(res=>{
    try{
      const u = new SpeechSynthesisUtterance(text);
      const v = chooseVoice();
      if(v) u.voice = v;
      u.lang = 'en-US';
      u.rate = 1.0;
      u.onend = res;
      speechSynthesis.speak(u);
    }catch(e){ console.error(e); res(); }
  });
}

async function playRepeated(text, times, gap){
  for(let i=0;i<times;i++){
    await speakOnce(text);
    if(i<times-1) await new Promise(r=>setTimeout(r,gap));
  }
}

document.getElementById('playWord').addEventListener('click', ()=> playRepeated(data[idx][0], 1, 300));
document.getElementById('playSentence').addEventListener('click', ()=> playRepeated(data[idx][3], 1, 300));
document.getElementById('playBoth').addEventListener('click', async ()=>{
  // word x3 then pause then sentence x3
  await playRepeated(data[idx][0], 3, 400);
  await new Promise(r=>setTimeout(r, 1200));
  await playRepeated(data[idx][3], 3, 900);
});

document.getElementById('nextBtn').addEventListener('click', ()=>{ idx=(idx+1)%data.length; render(); });
document.getElementById('shuffle').addEventListener('click', ()=>{ for(let i=data.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [data[i],data[j]]=[data[j],data[i]]; } idx=0; render(); });
document.getElementById('toggleCn').addEventListener('click', ()=>{ const el=document.getElementById('cn'); el.style.visibility = el.style.visibility==='hidden' ? 'visible' : 'hidden'; });

// ensure voices are loaded (especially on iOS)
if(window.speechSynthesis){
  window.speechSynthesis.onvoiceschanged = ()=>{};
}
</script>
</body>
</html>